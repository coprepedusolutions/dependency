name: Upload AAR to GitHub Packages

on:
  push:
    branches: [ main ]

permissions:
  contents: read
  packages: write

jobs:
  upload-aar:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Locate AAR file
        run: |
          echo "📁 Locating AAR file..."
          find . -name "*.aar" > aar_path.txt
          AAR_PATH=$(cat aar_path.txt)
          echo "aar=$AAR_PATH" >> $GITHUB_OUTPUT
        id: locate-aar

      - name: Upload to GitHub Packages
        run: |
          echo "🚀 Uploading ${{ steps.locate-aar.outputs.aar }} to GitHub Packages..."
          curl -X PUT \
            -u "${{ secrets.GITHUB_ACTOR }}:${{ secrets.GITHUB_TOKEN }}" \
            -H "Content-Type: application/java-archive" \
            --data-binary @"${{ steps.locate-aar.outputs.aar }}" \
            "https://maven.pkg.github.com/OWNER/REPO/com/example/library/1.0.0/library-1.0.0.aar"


